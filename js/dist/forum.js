(()=>{var o={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return o.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)o.o(r,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t)};(()=>{"use strict";const t=flarum.core.compat["forum/app"];var r=o.n(t);const n=flarum.core.compat["common/extend"],e=flarum.core.compat["forum/components/HeaderSecondary"];var a=o.n(e);const i=flarum.core.compat["forum/components/SessionDropdown"];var s=o.n(i);const c=flarum.core.compat["forum/components/LogInModal"];var u=o.n(c);const l=flarum.core.compat["common/components/Button"];var f=o.n(l);r().initializers.add("aditya-wiguna-jwt-sso",(function(){var o=function(o,t){void 0===t&&(t=null);try{return r().forum&&r().forum.attribute?r().forum.attribute(o):t}catch(o){return t}},t=function(){try{return o("baseUrl")||r().forum.attribute("url")||""}catch(o){return""}},e=function(){o("jwt-sso.overrideLogin",!1)?((0,n.extend)(a().prototype,"items",(function(o){r().session.user||o.replace("logIn",f().component({className:"Button Button--link",onclick:function(){window.location.href=t()+"/auth/sso/login"}},r().translator.trans("core.forum.header.log_in_link")))})),(0,n.extend)(u().prototype,"oncreate",(function(){this.hide(),window.location.href=t()+"/auth/sso/login"}))):(0,n.extend)(u().prototype,"fields",(function(o){o.add("sso-login",m("div",{className:"Form-group"},m(f(),{className:"Button Button--primary Button--block",onclick:function(){window.location.href=t()+"/auth/sso/login"}},r().translator.trans("jwt-sso.forum.login_with_sso"))),-10)})),(0,n.extend)(s().prototype,"items",(function(o){r().session.user&&o.replace("logOut",f().component({icon:"fas fa-sign-out-alt",onclick:function(){fetch(t()+"/auth/sso/logout",{method:"POST",headers:{"X-CSRF-Token":r().session.csrfToken}}).then((function(){window.location.reload()}))}},r().translator.trans("core.forum.header.log_out_button")))}));var e=new URLSearchParams(window.location.search).get("sso_error");if(e){var i;switch(e){case"missing_token":i=r().translator.trans("jwt-sso.forum.error.missing_token");break;case"invalid_state":i=r().translator.trans("jwt-sso.forum.error.invalid_state");break;case"invalid_token":i=r().translator.trans("jwt-sso.forum.error.invalid_token");break;default:i=r().translator.trans("jwt-sso.forum.error.generic",{error:e})}r().alerts.show({type:"error",content:i}),window.history.replaceState({},document.title,window.location.pathname)}};try{if(r().forum&&r().forum.data)e();else{var i=function(o,t){void 0===o&&(o=1),void 0===t&&(t=10),setTimeout((function(){r().forum&&r().forum.data?e():o<t?i(o+1,t):console.warn("JWT SSO: Could not initialize - forum data not available")}),100*o)};i()}}catch(o){console.error("JWT SSO initialization error:",o),setTimeout((function(){try{e()}catch(o){console.error("JWT SSO fallback initialization failed:",o)}}),1e3)}}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map